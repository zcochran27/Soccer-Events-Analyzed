<!DOCTYPE html>
<html lang="en">

<head>
    <script type="module" src="mainV2Test.js"></script>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="goals/goals.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <meta charset="UTF-8">
    <title>XGBoost Prediction</title>
</head>

<body>
    <h1>Pass Sequence xG Predictor</h1>
    <h2>This is a tool to predict the probability of a pass being successful based on the pass type, height, and location.</h2>
    <!-- Put the clip embedding and explainations here -->
    
    
    <div id="main-container">
      <div class="canvas-container">
        <canvas id="pitchCanvas" width="720" height="480"></canvas>
      </div>
    <!-- <label>
        <input type="checkbox" id="dribbleToggle" />
        <label for="dribbleToggle">Dribble Mode</label>
    </label> -->
      <div id="controls">
          <label for="passType">Select Pass Type:</label>
          <select id="passType" name="passType">
            <option value="normal">Normal Pass</option>
            <option value="Cross">Cross</option>
            <option value="Through Ball">Through Ball</option>
            <option value="Cut-back">Cut Back</option>
            <option value="Switch">Switch</option>
            <option value="Throw-in">Throw-in</option>
            <option value="Corner">Corner</option>
            <option value="Free Kick">Free Kick</option>
            <option value="Goal Kick">Goal Kick</option>
          </select>
      
          <label for="passHeight">Select Pass Height:</label>
          <select id="passHeight" name="passHeight">
            <option value="Ground">Ground Pass</option>
            <option value="Low">Low Pass</option>
            <option value="High">High Pass</option>
          </select>
      
          <button id="undoBtn">Undo last pass</button>
          <button id="shootBtn">Shoot!</button>
          <button id="predictBtn">Predict Play Probability</button>
        </div>
      <p id="predictionResult"></p>
      <div id="loadingSpinner" class="spinner" style="display: none;"></div>
    <script>
        async function makePrediction() {
            let features = [];
            
            // Collect values from all 6 passes
            for(let i = 1; i <= 5; i++) {
                const startX = parseFloat(document.getElementById(`startX${i}`).value);
                const startY = parseFloat(document.getElementById(`startY${i}`).value);
                const endX = parseFloat(document.getElementById(`endX${i}`).value);
                const endY = parseFloat(document.getElementById(`endY${i}`).value);
                const outcome = parseFloat(document.getElementById(`outcome${i}`).value);
                
                features = features.concat([[startX, startY], [endX, endY], outcome]);
            }
            console.log(features);
            const payload = {
                features: features
            };
            
            const response = await fetch("https://soccer-events-analyzed.onrender.com/predict", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(payload)
            });

            if (response.ok) {
                const data = await response.json();
                console.log(data.prediction.toFixed(4))
                document.getElementById("result").textContent = "Prediction: " + data.prediction.toFixed(4);
            } else {
                document.getElementById("result").textContent = "Error: " + response.status;
            }
        }
    </script>
      <div id="heatmap"></div>
      <script src="../goals/goals.js"></script>
</div>
</body>

</html>